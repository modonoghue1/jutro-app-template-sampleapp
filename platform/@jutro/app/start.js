import _extends from"@babel/runtime-corejs3/helpers/extends";import _objectWithoutProperties from"@babel/runtime-corejs3/helpers/objectWithoutProperties";import React from"react";import ReactDOM from"react-dom";import Loadable from"react-loadable";import RedBox from"redbox-react";import{loadConfiguration,getConfigValue}from"@jutro/config";import{initDefaultGA,initDefaultMixpanel,initDefaultDataDog,publish,JUTRO_TOPICS}from"@jutro/events";import{ThemeProvider}from"@jutro/theme";import{hot}from"react-hot-loader";import{warning}from"@jutro/logger";import{ApplicationRoot}from"./ApplicationRoot";import{InitLoading}from"./InitLoading";const errorListener=errorEvent=>{publish(JUTRO_TOPICS.UNKNOWN_ERROR,errorEvent)};export const initGlobalErrorCapture=()=>window.addEventListener("error",errorListener);export const start=(Main,launchProps={})=>{const _launchProps$config=launchProps.config,config=void 0===_launchProps$config?[]:_launchProps$config,trackingConfig=launchProps.trackingConfig,rootId=launchProps.rootId,themeConfig=launchProps.themeConfig,_launchProps$themePro=launchProps.themeProviderProps,themeProviderProps=void 0===_launchProps$themePro?{}:_launchProps$themePro,disableThemeProvider=launchProps.disableThemeProvider,_launchProps$LoadingC=launchProps.LoadingComponent,LoadingComponent=void 0===_launchProps$LoadingC?InitLoading:_launchProps$LoadingC,_launchProps$ErrorLoa=launchProps.ErrorLoadingComponent,ErrorLoadingComponent=void 0===_launchProps$ErrorLoa?RedBox:_launchProps$ErrorLoa,_launchProps$onInit=launchProps.onInit,onInit=void 0===_launchProps$onInit?()=>{}:_launchProps$onInit,onRender=launchProps.onRender,appProps=_objectWithoutProperties(launchProps,["config","trackingConfig","rootId","themeConfig","themeProviderProps","disableThemeProvider","LoadingComponent","ErrorLoadingComponent","onInit","onRender"]);loadConfiguration(...config),(trackingConfig=>{const gaTrackingId=getConfigValue("GA_TRACKING_ID"),mixpanelTrackingId=getConfigValue("MIXPANEL_TRACKING_ID"),dataDogClientToken=getConfigValue("JUTRO_DATA_DOG_CLIENT_TOKEN");gaTrackingId||mixpanelTrackingId||dataDogClientToken?(dataDogClientToken&&initDefaultDataDog(trackingConfig),gaTrackingId&&initDefaultGA(trackingConfig),mixpanelTrackingId&&initDefaultMixpanel(trackingConfig),window.addEventListener("error",errorListener)):warning("To enable Jutro analytics you need to provide a gaTrackingId, mixpanelTrackingId, dataDogClientToken , using env vars (GA_TRACKING_ID, MIXPANEL_TRACKING_ID or JUTRO_DATA_DOG_CLIENT_TOKEN). More details about tracking can be found here - https://docs.int.ccs.guidewire.net/jutro/documentation/next/analytics/")})(trackingConfig);const LoadableRoot=Loadable.Map({loader:{init:()=>Promise.resolve(onInit())},loading:props=>props.error?React.createElement(ErrorLoadingComponent,{error:props.error}):React.createElement(LoadingComponent,null),render:()=>React.createElement(ApplicationRoot,_extends({main:Main},appProps))}),Root=LoadableRoot,WrappedComponent=disableThemeProvider?React.createElement(Root,null):React.createElement(ThemeProvider,_extends({initialConfig:themeConfig},themeProviderProps),React.createElement(Root,null));ReactDOM.render(WrappedComponent,document.getElementById(rootId),onRender)};