import _objectWithoutProperties from"@babel/runtime-corejs3/helpers/objectWithoutProperties";import React,{lazy,Suspense}from"react";import PropTypes from"prop-types";import{Loader}from"@jutro/components";import{importMicroApp}from"./importMicroApp";import{applyDevProps}from"./utils";const microAppCache=new Map;export const getMicroAppCache=()=>microAppCache;const launchPropOverridesProps={routerBasename:PropTypes.string},jutroProps={launchPropOverrides:PropTypes.shape(launchPropOverridesProps),configOverrides:PropTypes.objectOf(PropTypes.any),componentMapExtensions:PropTypes.objectOf(PropTypes.elementType.isRequired)},optionalProps={loaderComponent:PropTypes.elementType,errorBoundaryComponent:PropTypes.elementType,jutro:PropTypes.shape(jutroProps)},regularProps={remoteScope:PropTypes.string.isRequired,...optionalProps},devProps={remoteScope:PropTypes.string,...optionalProps},propTypes={...regularProps,devProps:PropTypes.shape(devProps)},defaultProps={loaderComponent:Loader};export const MicroApp=allProps=>{const _ref=applyDevProps(allProps),remoteScope=_ref.remoteScope,LoaderComponent=_ref.loaderComponent,errorBoundaryComponent=_ref.errorBoundaryComponent,props=_objectWithoutProperties(_ref,["remoteScope","loaderComponent","errorBoundaryComponent"]),CachedMicroApp=((remoteScope,errorBoundaryComponent)=>{const CachedMicroApp=microAppCache.get(remoteScope);if(CachedMicroApp)return CachedMicroApp;const MicroApp=lazy(importMicroApp(remoteScope,errorBoundaryComponent));return microAppCache.set(remoteScope,MicroApp),MicroApp})(remoteScope,errorBoundaryComponent);return React.createElement(Suspense,{fallback:React.createElement(LoaderComponent,null)},React.createElement(CachedMicroApp,props))};MicroApp.defaultProps=defaultProps,MicroApp.propTypes=propTypes,MicroApp.displayName="MicroApp",MicroApp.__docgenInfo={description:"",methods:[],displayName:"MicroApp",props:{loaderComponent:{defaultValue:{value:"Loader",computed:!0},type:{name:"elementType"},required:!1,description:"The loader component you wish to render instead of the default one when the microapp assets are loading"},remoteScope:{type:{name:"string"},required:!0,description:"The name for the remoteScope pointing to the microapp URL in your shell configs"},errorBoundaryComponent:{type:{name:"elementType"},required:!1,description:"The error boundary component you wish to render instead of the default one in case a microapp throws an error"},jutro:{type:{name:"shape",value:{launchPropOverrides:{name:"shape",value:{routerBasename:{name:"string",required:!1}},required:!1},configOverrides:{name:"objectOf",value:{name:"any"},required:!1},componentMapExtensions:{name:"objectOf",value:{name:"elementType"},required:!1}}},required:!1,description:"Optional props to control Jutro related behavior"},devProps:{type:{name:"shape",value:{remoteScope:{name:"string",description:"The name for the remoteScope pointing to the microapp URL in your shell configs",required:!1}}},required:!1,description:"Prop overrides to be used only in dev mode, these follow the same structure as the component props"}}},MicroApp.__docgenInfo={componentName:"MicroApp",packageName:"@jutro/lab-preview-micro-app",description:"",displayName:"MicroApp",methods:[],actualName:"MicroApp",props:{remoteScope:{type:{name:"string"},required:!0,description:"The name for the remoteScope pointing to the microapp URL in your shell configs"},loaderComponent:{type:{name:"elementType"},required:!1,description:"The loader component you wish to render instead of the default one when the microapp assets are loading",defaultValue:{value:"Loader",computed:!0}},errorBoundaryComponent:{type:{name:"elementType"},required:!1,description:"The error boundary component you wish to render instead of the default one in case a microapp throws an error"},jutro:{type:{name:"shape",value:{launchPropOverrides:{name:"shape",value:{routerBasename:{name:"string",required:!1}},required:!1},configOverrides:{name:"objectOf",value:{name:"any"},required:!1},componentMapExtensions:{name:"objectOf",value:{name:"elementType"},required:!1}}},required:!1,description:"Optional props to control Jutro related behavior"},devProps:{type:{name:"shape",value:{remoteScope:{name:"string",description:"The name for the remoteScope pointing to the microapp URL in your shell configs",required:!1}}},required:!1,description:"Prop overrides to be used only in dev mode, these follow the same structure as the component props"}}};