import _objectWithoutProperties from"@babel/runtime-corejs3/helpers/objectWithoutProperties";import React from"react";import ReactDOM from"react-dom";import{start as renderApp}from"@jutro/app";import{error}from"@jutro/logger";import merge from"lodash/merge";import{buildRendererName,buildUnmounterName,getNamespacedProps}from"./utils";import{MicroAppStarter}from"./MicroAppStarter";import{getWindowAsObject}from"./types";import{EmbeddedLoader}from"./EmbeddedLoader";export const exposeMicroApp=(Main,launchProps)=>{var _document$currentScri;const microAppName=null===(_document$currentScri=document.currentScript)||void 0===_document$currentScri?void 0:_document$currentScri.getAttribute("micro-app-name");if(!microAppName)return void error('Unable to load micro-app-name from "document.currentScript"');const window=getWindowAsObject();window[buildRendererName(microAppName)]=(containerId,allProps)=>{const _getNamespacedProps=getNamespacedProps(allProps),jutro=_getNamespacedProps.jutro,propsFromShell=_objectWithoutProperties(_getNamespacedProps,["jutro"]),_jutro$launchPropOver=jutro.launchPropOverrides,launchPropOverrides=void 0===_jutro$launchPropOver?{}:_jutro$launchPropOver,_jutro$configOverride=jutro.configOverrides,microAppLaunchProps=merge({},launchProps,{rootId:containerId,disableThemeProvider:!0,disableToastProvider:!0,loaderComponent:EmbeddedLoader},launchPropOverrides,{config:[void 0===_jutro$configOverride?{}:_jutro$configOverride]});renderApp((propsFromAppRoot=>React.createElement(MicroAppStarter,{propsFromAppRoot:propsFromAppRoot,propsFromShell:propsFromShell,jutroProps:jutro,microAppName:microAppName,Main:Main})),microAppLaunchProps)},window[buildUnmounterName(microAppName)]=containerId=>{const mountedElement=document.getElementById(containerId);mountedElement&&ReactDOM.unmountComponentAtNode(mountedElement)}};