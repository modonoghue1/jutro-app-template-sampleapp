import _extends from"@babel/runtime-corejs3/helpers/extends";import _slicedToArray from"@babel/runtime-corejs3/helpers/slicedToArray";import React,{useRef,useCallback,useState}from"react";import{DATA_TYPE_OBJECT}from"@jutro/prop-types";import cx from"classnames";import{useInitializeIntlPhoneNumber,useSetNumberOnBlur}from"./intlPhoneNumberHooks";import styles from"./IntlPhoneNumberField.module.css";export const IntlPhoneNumberInput=({className:className,id:id,defaultCountry:defaultCountry,onChange:onChange,dataType:dataType,disabled:disabled,required:required,validateNumber:validateNumber,value:value,placeholder:placeholder,noDropdown:noDropdown,testId:testId,...restProps})=>{const inputEl=useRef(null),classes=cx(styles.phoneNumber,className),_useState=useState(!1),_useState2=_slicedToArray(_useState,2),isFocused=_useState2[0],setIsFocused=_useState2[1];useInitializeIntlPhoneNumber(inputEl,defaultCountry,disabled,placeholder,noDropdown);const getInstance=()=>{var _window$intlTelInputG;return null===(_window$intlTelInputG=window.intlTelInputGlobals)||void 0===_window$intlTelInputG?void 0:_window$intlTelInputG.getInstance(inputEl.current)},getCountryDialCode=useCallback((()=>{var _getInstance;return null===(_getInstance=getInstance())||void 0===_getInstance?void 0:_getInstance.selectedCountryData.dialCode}),[]);useSetNumberOnBlur(value,getInstance,isFocused,noDropdown);const getCountryIsoString=useCallback((()=>{var _getInstance2;return null===(_getInstance2=getInstance())||void 0===_getInstance2?void 0:_getInstance2.selectedCountryData.iso2}),[]),getNumber=useCallback((format=>{var _getInstance3;return null===(_getInstance3=getInstance())||void 0===_getInstance3?void 0:_getInstance3.getNumber(format)}),[]),formatValue=useCallback((()=>{const countryCode=getCountryDialCode(),countryIsoString=getCountryIsoString(),phoneNumber=getNumber().replace(`+${countryCode}`,"");if(!phoneNumber||!countryIsoString)return;return dataType===DATA_TYPE_OBJECT?{countryCode:{code:countryIsoString},phoneNumber:phoneNumber.trim()}:`+${countryCode}${phoneNumber.trim()}`}),[dataType,getCountryDialCode,getNumber,required,getCountryIsoString]);return React.createElement("input",_extends({disabled:disabled,ref:inputEl,className:classes,id:id,type:"tel",onChange:()=>{onChange(formatValue())},onBlur:()=>{setIsFocused(!1),(()=>{const formattedPhoneInput=getNumber(1);"string"==typeof formattedPhoneInput&&getInstance().setNumber(formattedPhoneInput)})();const isValid=getInstance().isValidNumber(),validationError=getInstance().getValidationError();return onChange(formatValue()),noDropdown&&void 0===value?validateNumber(!0):getInstance().getNumber()?validateNumber(isValid,validationError):validateNumber(!0)},onFocus:()=>{setIsFocused(!0),validateNumber(!0)},required:required,placeholder:placeholder,"data-testid":testId},restProps))};IntlPhoneNumberInput.__docgenInfo={description:"",methods:[],displayName:"IntlPhoneNumberInput"},IntlPhoneNumberInput.__docgenInfo={componentName:"IntlPhoneNumberInput",packageName:"@jutro/components",description:"",displayName:"IntlPhoneNumberInput",methods:[],actualName:"IntlPhoneNumberInput"};