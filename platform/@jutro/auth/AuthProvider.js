import React from"react";import{Route,Switch}from"react-router-dom";import{getConfigValue}from"@jutro/config";import{logDeprecationMessage}from"@jutro/platform";import{AuthContextProvider}from"./AuthContextProvider";import{AuthStateProvider}from"./AuthStateProvider";import{LoginCallback}from"./LoginCallback";export const OPENID_SCOPE="openid";export const DEFAULT_EXPIRE_EARLY_SECONDS=30;export const AUTO_RENEW=!0;export const DEFAULT_STORAGE="localStorage";const getTokenManagerConfig=()=>{const expireEarlySeconds=getConfigValue("JUTRO_AUTH_EXPIRE_EARLY_SECONDS",30),autoRenew=getConfigValue("JUTRO_AUTH_AUTO_RENEW",true),storage=getConfigValue("JUTRO_AUTH_STORAGE","localStorage");return"cookie"===storage&&logDeprecationMessage("JUTRO_AUTH_STORAGE=cookie","JUTRO_AUTH_STORAGE=localStorage","See rationale: https://confluence.guidewire.com/x/gdUmIQ.","7.0.0"),{expireEarlySeconds:expireEarlySeconds,storage:storage,autoRenew:autoRenew}};export const AuthProvider=({children:children,authErrorComponent:authErrorComponent})=>{const authConfig=(()=>{const scopes=getConfigValue("JUTRO_AUTH_SCOPE","openid,profile,email").split(",");return-1===scopes.indexOf("openid")&&scopes.push("openid"),{isEnabled:getConfigValue("JUTRO_AUTH_ENABLED",!1),issuer:getConfigValue("JUTRO_AUTH_ISSUER",""),clientId:getConfigValue("JUTRO_AUTH_CLIENT_ID",""),redirectBase:getConfigValue("JUTRO_AUTH_REDIRECT_BASE",window.location.origin),redirectPath:getConfigValue("JUTRO_AUTH_REDIRECT_PATH",""),scopes:scopes,pkce:getConfigValue("JUTRO_AUTH_PKCE_ENABLED",!1),tokenManager:getTokenManagerConfig()}})();if(authConfig.isEnabled){const issuer=authConfig.issuer,clientId=authConfig.clientId,redirectBase=authConfig.redirectBase,redirectPath=authConfig.redirectPath,scopes=authConfig.scopes,pkce=authConfig.pkce,tokenManager=authConfig.tokenManager,redirectUri=`${redirectBase}${redirectPath}`;return React.createElement(AuthStateProvider,{issuer:issuer,clientId:clientId,redirectUri:redirectUri,scopes:scopes,pkce:pkce,tokenManager:tokenManager},React.createElement(AuthContextProvider,null,React.createElement(Switch,null,React.createElement(Route,{path:redirectPath,render:()=>React.createElement(LoginCallback,{errorComponent:authErrorComponent})}),children)))}return React.createElement(React.Fragment,null,children)};AuthProvider.__docgenInfo={description:"A HOC that wraps children components in Okta Security. This will initialize the\nokta configuration and set up a callback route to handle the login redirect.\nWrapping will only happen if authentication is enabled, otherwise the original\ncomponent will be returned, unwrapped.",methods:[],displayName:"AuthProvider"},AuthProvider.__docgenInfo={componentName:"AuthProvider",packageName:"@jutro/auth",description:"A HOC that wraps children components in Okta Security. This will initialize the\nokta configuration and set up a callback route to handle the login redirect.\nWrapping will only happen if authentication is enabled, otherwise the original\ncomponent will be returned, unwrapped.",displayName:"AuthProvider",methods:[],actualName:"AuthProvider"};